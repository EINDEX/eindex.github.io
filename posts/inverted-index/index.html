<!DOCTYPE html>
<html lang="en" charset="utf-8">
  





<head>
  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://preview.blog-2j7.pages.dev/feed.xml">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="author" itemprop="author" content="EINDEX">
  
  <title>倒排索引 &bull; EINDEX&#x27;s Blog</title>
  <meta property="og:title" content="倒排索引 &bull; EINDEX&#x27;s Blog" />
  

  <!-- Required meta tags -->
  <meta charset="utf-8" />


  <!-- **** BEGINNING, favicons **** -->

  <!-- generics -->

  <!-- iOS -->

  <!-- Android -->

  <!-- Windows 8, IE 10 -->

  <!-- Windows 8.1 and up, IE 11 -->

  <!-- **** CONCLUSION, favicons **** -->

  <!-- CSS/SCSS -->
  <link rel="stylesheet" href="https://preview.blog-2j7.pages.dev/css/index.css?h=f8faf511a8be60c25ce46e10d43e25cc133e48203f3dc383262447b1abda9301" />  <style>@-moz-document url-prefix() {.lazy:-moz-loading {visibility:hidden;}}.ieOnly {display: none;}@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {.ieOnly {display: block;}}</style>
  
  <link rel="stylesheet" href="https://preview.blog-2j7.pages.dev/styles/fontawesome.min.css?h=7d272de35b410fb165377550cdf9c4d3a80fbbcc961e111914e4d5c0eaf5729f">

  <link rel="webmention" href="https://webmention.io/eindex.me/webmention" />
  <link rel="pingback" href="https://webmention.io/eindex.me/xmlrpc" />
  
  
  
  <link rel="apple-touch-icon" sizes="512x512" href="/favicon-512.png">
  
  <link rel="icon" type="image/png" sizes="512x512" href="/favicon-512.png">
  
  
  <link rel="icon" type="image/png" sizes="192x192" href="/favicon-192.png">
  
  <link rel="manifest" href="/manifest.json">

  



  
    
  

  
    
  
    
  





<meta property="og:url" content="https://preview.blog-2j7.pages.dev/posts/inverted-index/">
<meta property="og:site_name" content="EINDEX&#x27;s Blog">
<meta property="og:image" content="https://preview.blog-2j7.pages.dev/images/avatar.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="倒排索引 &bull; EINDEX&#x27;s Blog">

<meta name="twitter:site" content="@eindex_li">
<meta name="twitter:creator" content="@eindex_li">
<meta name="twitter:image" content="https://preview.blog-2j7.pages.dev/images/avatar.png">

<script type="application/ld+json">
    {
      "@context": "https://schema.org/",
      "@type": "BlogPosting",
      "headline": "倒排索引",
      "image": "https://preview.blog-2j7.pages.dev/images/avatar.png",
      
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://preview.blog-2j7.pages.dev/posts/inverted-index/"
      },
      
      "datePublished": "2019-08-27",
      
      
      "author": {
        "@type": "Person",
        "name": "EINDEX",
        "url": "https://preview.blog-2j7.pages.dev/about"
      },
      "publisher": {
        "@type": "Organization",
        "name": "EINDEX's Blog",
        "logo": {
          "@type": "ImageObject",
          "url": "https://preview.blog-2j7.pages.dev/images/avatar.png"
      },
      "keywords": ["算法","Index","Search Engine"]
    }
</script>

  
  
  
</head>
  <body>
    <nav class="navbar">
    <ul class="items">
      <li>
        
        <a class="site-link" href="https:&#x2F;&#x2F;preview.blog-2j7.pages.dev&#x2F;"><img
            class="avatar"
            src="https:&#x2F;&#x2F;preview.blog-2j7.pages.dev&#x2F;processed_images&#x2F;985d495e6e585ad000.png"
            alt="Workflow"
        /><span class="site-name">EINDEX&#x27;s Blog</span></a>
      </li>
      <li class="delimiter"></li>
      
      <li class="button">
        <a
          href="https://preview.blog-2j7.pages.dev/archive/"
          >归档</a
        >
      </li>
      
      <li class="button">
        <a
          href="https://preview.blog-2j7.pages.dev/links/"
          >友链</a
        >
      </li>
      
      <li class="button">
        <a
          href="https://preview.blog-2j7.pages.dev/about/"
          >关于</a
        >
      </li>
      
    </ul>
</nav>


    <div class="content">
        <main>
            
  <article data-clarity-region="article">
    
<section class="header">
<section class="title-area">
    
    <h1 class="title">  
    <a href="https:&#x2F;&#x2F;preview.blog-2j7.pages.dev&#x2F;posts&#x2F;inverted-index&#x2F;">倒排索引</a>
    </h1>
  </section>
  <section class="meta-area">
  
    <span><i class="far fa-calendar-days"></i><time>2019-08-27</time></span>
  
  
    
    
    <a class="categories"  href="https:&#x2F;&#x2F;preview.blog-2j7.pages.dev&#x2F;categories&#x2F;suan-fa&#x2F;"><i class="fa-solid fa-inbox"></i>算法</a>
  
    <span><i class="fas fa-clock"></i> 5 mins</span>
  </section>
</section>

    <section class="main">
        
        <p>世界上最伟大的互联网产品,说是搜索引擎,绝对没有别的产品可以替代,尤其是伟大的先在市场占用率最高的搜索引擎,Google Search.</p>
<p>还有很多差一大截的,比如 Bing, Yahoo 和 YANDEX.</p>
<span id="continue-reading"></span><h2 id="什么是搜索引擎">什么是搜索引擎</h2>
<p>所谓搜索引擎，就是根据用户需求与一定算法，运用特定策略从互联网检索出制定信息反馈给用户的一门检索技术。</p>
<p>搜索引擎技术的核心模块一般包括爬虫、索引、检索和排序等，同时可添加其他一系列辅助模块，以为用户创造更好的网络使用环境。 </p>
<h2 id="搜索引擎干了些什么">搜索引擎干了些什么</h2>
<p>简单的说搜索引擎从网络上爬取网页,然后对网页信息进行提取,构建正排索引,然后分析网页内容,建立倒排文件.</p>
<p>接下来我将依次介绍 正排索引、 倒排索引 等知识点.</p>
<h2 id="正排索引">正排索引</h2>
<p>正排索引通常是 
id-document 的键值对</p>
<table><thead><tr><th>id</th><th>name</th><th>context</th><th>eng_context</th></tr></thead><tbody>
<tr><td>1</td><td>小明</td><td>今天吃了3个包子</td><td>today eating 3 baozi</td></tr>
<tr><td>2</td><td>小仓</td><td>最后一天看了一本书</td><td>read a book last day</td></tr>
<tr><td>3</td><td>仓颉</td><td>去年造了个新华字典</td><td>make a xinhua dictionary last year</td></tr>
</tbody></table>
<h2 id="倒排索引">倒排索引</h2>
<p>倒排索引是关键词到id列表的映射关系.</p>
<p>倒排索引里面左边的列叫做 term , 里面存储的通常是一个关键词; 
右边的列叫做 posting list,里面存储的是文档的id.</p>
<p>左侧的一列一起叫做 term dictionary.</p>
<p>首先上面有每个 document 有3个 field , 所以会创建3个倒排索引.</p>
<p>如果使用默认的英文分词器,那么表格会创建的索引大概是下面这个样子:</p>
<p>name index:</p>
<table><thead><tr><th>term</th><th>posting list</th></tr></thead><tbody>
<tr><td>小</td><td>[1, 2]</td></tr>
<tr><td>仓</td><td>[2, 3]</td></tr>
<tr><td>明</td><td>[1]</td></tr>
<tr><td>颉</td><td>[3]</td></tr>
</tbody></table>
<p>context index:</p>
<table><thead><tr><th>term</th><th>posting list</th></tr></thead><tbody>
<tr><td>个</td><td>[1, 3]</td></tr>
<tr><td>了</td><td>[1, 2, 3]</td></tr>
<tr><td>今</td><td>[1]</td></tr>
<tr><td>...</td><td>...</td></tr>
</tbody></table>
<p>eng_context index:</p>
<table><thead><tr><th>term</th><th>posting list</th></tr></thead><tbody>
<tr><td>last</td><td>[2, 3]</td></tr>
<tr><td>a</td><td>[2, 3]</td></tr>
<tr><td>dictionary</td><td>[3]</td></tr>
<tr><td>...</td><td>...</td></tr>
</tbody></table>
<hr />
<p>读到这里想来你也会有些许疑问?</p>
<ul>
<li>比 MySQL Index 的优势在哪?</li>
<li>当有1亿 Term 时如何高效查询?</li>
<li>联合查询怎么办?</li>
<li>相关度排序?</li>
</ul>
<h2 id="Term_index">Term index</h2>
<p>假象一下我们现在有 1 亿个 term, 那么这个 trem dictionary 会占多少内存呢?
假设每个 trem 占用内存 6 byte, 那么亿个大约占用 0.6 GB, 那么如果是一个非常复杂的文档, 岂不是内存不够用?
而且为什么搜索引擎的速度远远快于MySQL 的索引速度?</p>
<p>首先 Trem Index 实际上是一种字典树(前缀树), 可以将 term dictionary 里的内容组成树状结构.
下图会是一个普通的字典树. 
<img src="https://preview.blog-2j7.pages.dev/posts/inverted-index/media/15669198838069/15673442795943.jpg" alt="" /></p>
<p>而 Term Index 的 Value 就是 Term 在磁盘中的位置.</p>
<p>而且 Trem Index 通常会被缓存到内存中, 再加上优秀的树结构, 所以查询速度极快, 字典树的数据结构优势, 使体积远小于 term dictonary.</p>
<p>快于 MySQL 的主要原因是, 减少了访问磁盘的次数.MySQL 的B+树会在磁盘中多次读写不同位置, 而使用 term index , 则只会在匹配到 term 时进行一次磁盘访问.</p>
<h2 id="联合查询">联合查询</h2>
<p>如何进行索引的联合查询, 当程序获得多个Posting list 那么程序需要从list 中进行多次交集并集操作.如何减少这些操作呢?</p>
<p>通常有两个解决方案.</p>
<ul>
<li>bitset</li>
<li>跳表</li>
</ul>
<p>可以自己去看一下相关的工作原理。</p>
<h2 id="END">END</h2>
<p>想必看完之后，你也对倒排索引工作原理有一定的了解了吧。感谢阅读！</p>

    </section>
    <section class="post-footer">
        
        
<div class="tags">
    <i class="fa-solid fa-tags"></i>
    
        <span class="tag"><a href="">Index</a></span>
    
        <span class="tag"><a href="">Search Engine</a></span>
    
</div>

    </section>
    
    <section class="comments">
        
<script src="https://giscus.app/client.js"
    data-repo="EINDEX&#x2F;blog"
    data-repo-id="R_kgDOGWb6Yg"
    data-category-id="DIC_kwDOGWb6Ys4CAKn-"
    data-mapping="pathname"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-theme="light"
    data-lang="zh-CN"
    crossorigin="anonymous"
    async>
</script>

    </section>
    
</article>


        </main>
        <aside>
            
        </aside>
    </div>
    <footer class="footer">
  <div class="content">
    <div class="item">
    </div>
    <div class="item"></div>
    <div class="item profile">
      <img class="avatar" src="/images/avatar.png" />
      <ul class="links">
        
        <li>
          <a href="https:&#x2F;&#x2F;github.com&#x2F;eindex" rel="me" target="_blank"
            ><i class="fab fa-github"></i><span>Github</span>
          </a>
        </li>
        
        <li>
          <a href="https:&#x2F;&#x2F;twitter.com&#x2F;eindex_li" rel="me" target="_blank"
            ><i class="fab fa-twitter"></i><span>Twitter</span>
          </a>
        </li>
        
        <li>
          <a href="https:&#x2F;&#x2F;t.me&#x2F;eindex" rel="me" target="_blank"
            ><i class="fab fa-telegram"></i><span>Telegram</span>
          </a>
        </li>
        
        <li>
          <a href="mailto:eindex.me@outlook.com" rel="me" target="_blank"
            ><i class="fas fa-envelope"></i><span>Email</span>
          </a>
        </li>
        
      </ul>
    </div>
  </div>
  
  
    
    
  
  <span class="webring">
<a href="https://xn--sr8hvo.ws/%F0%9F%95%90%F0%9F%89%91%F0%9F%88%B6/previous">←</a>
An IndieWeb Webring 🕸💍
<a href="https://xn--sr8hvo.ws/%F0%9F%95%90%F0%9F%89%91%F0%9F%88%B6/next">→</a>
</span>
  <a
    class="powered-by"
    href="https://github.com/EINDEX/qingzhuo"
    target="_blank"
    >Powered By QingZhuo
  </a>
  
</footer>

  </body>
  
</html>